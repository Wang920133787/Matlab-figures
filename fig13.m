close all
figure(1)
accr=0.005575057716842;
PF_Final=[0.00560564821104920,0.00561194334323038,0.00563785869254836,0.00563067393153424,0.00557302997601640,0.00557744195663189,0.00564666187947900,0.00558441728381835,0.00554684144802940,0.00556379737197593;0.00557720459611422,0.00560257851082138,0.00562027167795302,0.00562971354436424,0.00559441639872323,0.00556263245098759,0.00559726024972668,0.00555490852171038,0.00557387822324837,0.00561689722370266;0.00557699371845495,0.00557828801151263,0.00558471191263181,0.00558548433043627,0.00558821105185125,0.00558536611521926,0.00560274633547288,0.00556408909634908,0.00556509881291363,0.00555902770134338;0.00557655651590285,0.00559289214120596,0.00560334735396847,0.00557792147481225,0.00561693154409813,0.00559189901741142,0.00557094535643389,0.00558995158620484,0.00559671774727663,0.00558422040962543;0.00557730947607409,0.00559634469783853,0.00557849759217783,0.00560054703142490,0.00558733091657424,0.00559767238710229,0.00557814597967237,0.00557348810295670,0.00558479733016160,0.00556596781546667;0.00557640831805815,0.00560884915955728,0.00556706079110539,0.00560648678263391,0.00556321128480271,0.00559407317700861,0.00557533981262083,0.00558351156180488,0.00558145553598215,0.00560356497698617;0.00559985024275097,0.00558152618200253,0.00560021640546830,0.00557712990432107,0.00556074172483866,0.00560011396368442,0.00557758218583839,0.00557762204546565,0.00558197454425693,0.00558762680987494;0.00558897178701652,0.00558252508235020,0.00559291713099156,0.00558618187695138,0.00557794235887915,0.00557686955584324,0.00560176163344432,0.00559408002433491,0.00558814889517684,0.00561397271996804;0.00558792332018006,0.00557358686250099,0.00556490929089287,0.00560277896587549,0.00560352223529921,0.00559358636547818,0.00558505008154917,0.00560078762738185,0.00561017402910575,0.00557559248088033;0.00558584533322556,0.00560478627967110,0.00557437099265559,0.00557411969126020,0.00558640871748629,0.00559819754987605,0.00558946201603058,0.00561887584191672,0.00557787643583625,0.00559498906342584];
mean_PF=[0.00559783140943131;0.00559297613973518;0.00557900170861851;0.00559013831469399;0.00558401013294492;0.00558599614005601;0.00558443840085019;0.00559033710649561;0.00558979112591439;0.00559049319213842];
A_RERR=[1.21523861761938,1.38385811013008,2.13365037914151,2.08555258332498,1.49734193146460,1.23253752200227,1.91924092253844,1.64212711675451,2.05776289342125,1.44546235814709;0.773262478882891,1.05034585128291,1.58729732347149,1.75996834629424,1.52494835864117,1.05478819648967,0.990009139658577,1.61119289072621,1.19142527230321,0.658397371504679;0.928112912370560,0.941408401188882,1.40984056889521,1.14888214020142,1.13309156375478,1.25610224765542,0.880168148820558,0.862956281880406,1.12084343260486,1.03087228492832;0.709133310397416,0.946727708678948,1.27400943450556,1.25300138016745,0.850244447713810,0.949855657982569,0.957677319841773,1.04353396830877,0.854796557098169,1.10787869915170;0.919715006526602,1.16131820557190,0.815566715731794,0.730612089409947,0.877358579139610,1.24241047127066,1.28884063147562,0.983068258509610,0.743207625355394,0.929160466394841;0.795166643437457,1.13402840019942,0.753927416798475,0.974817055230432,0.790963805903051,0.743215681409597,0.709139625166577,0.989884790144856,0.941601888931689,0.743515673137594;0.908145273424916,0.614537279842043,0.954835922939262,0.796881701322552,0.809320580482641,0.942088251936266,0.687137175838284,0.749021973971845,0.767598653206845,0.962341466499331;0.698998433949630,0.893514426998295,0.716387738463500,0.851667196021658,0.776232203186289,0.713591056567877,0.862946971750083,0.884617540922480,0.598877544842844,0.778257806569188;0.865953045685921,0.673917396872014,0.644497416776741,0.689157194483388,0.785637542753159,0.804489488359102,0.794043722068585,0.667468798930030,0.567024655236134,0.686312004910884;0.714940187936801,0.652905265703272,0.712949393700815,0.692950218995508,0.831350845674305,0.556829892094579,0.836191823421159,0.774834270910109,0.659889715679093,0.693509316016935];
f1=plot([0 11] ,[accr accr],'k',...
        [0 11] ,0.99.*[accr accr],'r-.',[0 11] ,1.01.*[accr accr],'r-.',...
        [0 11] ,0.98.*[accr accr],'m--',[0 11] ,1.02.*[accr accr],'m--',...
    'LineWidth',1.5);

hold on
f2=boxplot(PF_Final');
set(f2,'Linewidth',1.5);
f3=plot(1:size(A_RERR,1),mean_PF,'bo','MarkerSize',5,...
    'MarkerEdgeColor','b','MarkerFaceColor','b', 'LineWidth',1.5);
hold off
box off
legend([f1(4),f1(2),f1(1),f3],...
    '2% error limit',...
    '1% error limit','Accurate result','Estimated mean value',...
    'FontName','Times new roman',...
    'NumColumns',2,'LineWidth',1.5,...
    'Location','northeast','FontSize',14);
xlabel('Sample size','Color','k');
ylabel('Failure probability','Color','k');
axis([0.5 10.5 5.4e-3 5.8e-3])
set(gca,'position',[0.11,0.15,0.85,0.78],...
    'xtick',1:1:10, 'xticklabel',...
    [20 40 60 80 100 120 140 160 180 200],'ytick',5.4e-3:1e-4:5.8e-3,'ycolor','k',...
    'FontName','Times new roman','FontSize',14,'LineWidth',1.5,'LabelFontSizeMultiplier',1) 
set(gcf,'unit','centimeters','color','w','position',[5 2 14 11]);



figure(2)
 [H,L] = meshgrid(-10:2:10);
 B1=[10.7142857142857,9.01360544217688,7.46753246753247,6.05590062111801,4.76190476190476,3.57142857142857,2.47252747252747,1.45502645502646,0.510204081632654,-0.369458128078819,-1.19047619047619;10.5691056910569,8.87533875338754,7.33555062823356,5.92965712265819,4.64092140921409,3.45528455284553,2.36085053158224,1.34748569707919,0.406504065040650,-0.469582282029720,-1.28726287262873;10.4251012145749,8.73819163292848,7.20463746779537,5.80443583876078,4.52091767881242,3.34008097165992,2.25007785736531,1.24081571449993,0.303643724696357,-0.568895714086278,-1.38326585695007;10.2822580645161,8.60215053763441,7.07478005865103,5.68022440392707,4.40188172043011,3.22580645161290,2.14019851116625,1.13500597371565,0.201612903225808,-0.667408231368189,-1.47849462365592;10.1405622489960,8.46720214190094,6.94596568090544,5.55701065130086,4.28380187416332,3.11244979919679,2.03120172999691,1.03004611036740,0.100401606425702,-0.765129483451048,-1.57295850066934;10,8.33333333333334,6.81818181818182,5.43478260869565,4.16666666666667,3,1.92307692307692,0.925925925925927,0,-0.862068965517242,-1.66666666666667;9.86055776892430,8.20053120849934,6.69141615356755,5.31352849471679,4.05046480743692,2.88844621513944,1.81581366840331,0.822635384388374,-0.0996015936254970,-0.958236021431517,-1.75962815405047;9.72222222222222,8.06878306878307,6.56565656565657,5.19323671497585,3.93518518518519,2.77777777777778,1.70940170940171,0.720164609053498,-0.198412698412699,-1.05363984674330,-1.85185185185185;9.58498023715415,7.93807641633729,6.44089112468559,5.07389585839491,3.82081686429513,2.66798418972332,1.60383095165704,0.618503879373446,-0.296442687747035,-1.14828949161783,-1.94334650856390;9.44881889763779,7.80839895013123,6.31710808876163,4.95549469359808,3.70734908136483,2.55905511811024,1.49909145972138,0.517643627879849,-0.393700787401574,-1.24219386369807,-2.03412073490814;9.31372549019608,7.67973856209151,6.19429590017825,4.83802216538789,3.59477124183007,2.45098039215686,1.39517345399698,0.417574437182282,-0.490196078431371,-1.33536173089926,-2.12418300653595];
 B2=[11.7653125000000,6.75925925925926,2.62232344102179,-0.826210240815321,-3.72377748842593,-6.17616000000000,-8.26567478379609,-10.0570289081949,-11.6015625000000,-12.9403624584854,-14.1065740740741;12.2173400000000,7.14973760932945,2.96193839218633,-0.528994822059666,-3.46218750000000,-5.94472192000000,-8.05992717341830,-9.87330589849108,-11.4368294460641,-12.7920898765837,-13.9726400000000;12.6730575000000,7.54340352013821,3.30432569496619,-0.229353168406345,-3.19846209490741,-5.71139456000000,-7.85250000000000,-9.68808311741096,-11.2707516399417,-12.6426069129526,-13.8376125925926;13.1324800000000,7.94026994924955,3.64949661908340,0.0727245828881422,-2.93259259259259,-5.47617024000000,-7.64338643604916,-9.50135446832292,-11.1033236151603,-12.4919086473410,-13.7014874074074;13.5956225000000,8.34034985422741,3.99746243425995,0.377248294567270,-2.66457031250000,-5.23904128000000,-7.43257965407374,-9.31311385459534,-10.9345399052478,-12.3399901594981,-13.5642600000000;14.0625000000000,8.74365619263578,4.34823441021788,0.684227829374539,-2.39438657407407,-5,-7.22007282658170,-9.12335517959661,-10.7643950437318,-12.1868465291730,-13.4259259259259;14.5331275000000,9.15020192203866,4.70182381667919,0.993673050053424,-2.12203269675926,-4.75903872000000,-7.00585912608102,-8.93207234669512,-10.5928835641399,-12.0324728361146,-13.2864807407407;15.0075200000000,9.56000000000000,5.05824192336590,1.30559381934742,-1.84750000000000,-4.51614976000000,-6.78993172507965,-8.73925925925926,-10.4200000000000,-11.8768641600722,-13.1459200000000;15.4856925000000,9.97306338408379,5.41750000000000,1.62000000000000,-1.57077980324074,-4.27132544000000,-6.57228379608557,-8.54490982065742,-10.2457388848397,-11.7200155807946,-13.0042392592593;15.9676600000000,10.3894050318540,5.77960931630354,1.93690145475466,-1.29186342592593,-4.02455808000000,-6.35290851160674,-8.34901793425799,-10.0700947521866,-11.5619221780311,-12.8614340740741;16.4534375000000,10.8090379008746,6.14458114199850,2.25630804635490,-1.01074218750000,-3.77584000000000,-6.13179904415112,-8.15157750342936,-9.89306213556851,-11.4025790315306,-12.7175000000000];
 surf(B1,H,L,'FaceColor','w' )
 hold on
 surf(B2,H,L,'FaceColor','w')
pit=[-1.43822013614756,-2.15579446006347,-1.48439826607102,-1.68264661678297,-0.553638472020340,2.22352163241903,2.16010625339087,2.08004237467233,2.05299458982799,2.17523364464959,1.92106293608310,2.56268430135162,1.95389315075584,2.18009538729666,2.89183035105360,1.66856830538866,1.90785815672462,1.52081844612934,1.42096339976277,1.89780956591537;-2.60634267359008,-2.09960284222601,-2.70301094079817,-2.60588502623691,-3.07400729371731,1.42322531129386,1.55407291355927,1.66195277069109,1.76523827538307,1.57253484820071,1.99394613537001,0.866439068392087,1.84633035022096,1.60782651304156,0.236741726993693,2.48135049431628,2.13944910265938,2.75475583997611,2.92584421631562,1.79914094743116;0.549040993555048,0.711772202655345,-0.798905346263016,-1.18345898572105,1.73563469038429,0.0281134839448042,-0.0764519253220106,0.354583356000267,-0.144497873334366,-0.533602837170892,0.0956267834624672,-0.718822802285500,0.908630905942993,-0.964438745603094,-0.426306800211774,0.142011602881390,-1.05523283726632,0.321885023447234,0.589339201873099,2.41033912366879];
 scatter3(pit(1,:),pit(2,:),pit(3,:),50,'MarkerFaceColor','b');
for i=1:length(pit)
    arrow([0,0,0],[pit(1,i),pit(2,i),pit(3,i)],20,'line',[0.1,0.5],[5,5])
end
 hold off
axis([-10 10 -10 10 -10 10])
set(gca,'position',[0.14,0.15,0.75,0.8],...
    'xtick',-10:4:10,'ytick',-10:4:10,'ztick',-10:4:10,......
    'GridLineStyle',':','FontName','Times new roman',...
    'LineWidth',1.5,'FontSize',14,'LabelFontSizeMultiplier',1)
set(gcf,'unit','centimeters','color','w','position',[25 2 12 10]);
xlabel('{\itB}/(mm)');
ylabel('{\itH}/(mm)');
zlabel('{\itL}/(mm)');
box off
